ssh -i "/home/kaiko/pin-final/mse_keypair.pem" ubuntu@ec2-184-73-149-21.compute-1.amazonaws.com


aws eks update-kubeconfig --region us-east-1 --name eks-cluster
kubectl get nodes
kubectl apply -f ./nginx.yaml
cd ..
cd 3-nginx/
kubectl apply -f ./nginx.yaml
kubectl get pods -o wide
kubectl get all
account_id="$(aws sts get-caller-identity --query "Account" --output text)"
 (me da el ID de la variable)
cat ~/.aws/config 
(vista de archivo configuracion aws)
nano ~/.aws/config
account_id="$(aws sts get-caller-identity --query "Account" --output text)"
echo $account_id 
kubectl apply -k "github.com/kubernetes-sigs/aws-ebs-csi-driver/deploy/kubernetes/overlays/stable/?ref=release-1.29"
eksctl create iamserviceaccount --name ebs-csi-controller-sa --namespace kube-system --cluster eks-cluster --attach-policy-arn arn:aws:iam::aws:policy/service-role/AmazonEBSCSIDriverPolicy --approve --role-only --role-name AmazonEKS_EBS_CSI_DriverRole --region us-east-1
kubectl get pod
kubectl get pvc,po,
kubectl get pvc,po
kubectl get deploy,svc,po
Install Prometheus
helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
helm repo add grafana https://grafana.github.io/helm-charts
helm repo update
kubectl create namespace prometheus
helm install prometheus prometheus-community/prometheus     --namespace prometheus     --set alertmanager.persistentVolume.storageClass="gp2"     --set server.persistentVolume.storageClass="gp2"
kubectl get deploy,svc,po
kubectl get deploy,svc,po -n prometheus
eksctl create addon --name aws-ebs-csi-driver --cluster eks-cluster --service-account-role-arn arn:aws:iam::$account_id:role/AmazonEKS_EBS_CSI_DriverRole --force --region us-east-1
kubectl get deploy,svc,po -n prometheus
watch -n 5 kubectl get deploy,svc,po -n prometheus
kubectl describe pvc prometheus-server -n prometheus
watch -n 5 kubectl get deploy,svc,po -n prometheus
kubectl port-forward -n prometheus deploy/prometheus-server 8080:9090 --address 0.0.0.0
kubectl apply -f ./nginx.yaml
kubectl get pod
kubectl get deploy,svc,po
